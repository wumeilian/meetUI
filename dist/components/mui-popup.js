!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e["mui-popup"]=t()}(this,function(){"use strict";function n(){if("function"==typeof HTMLElement)return HTMLElement;var e=function(){};return e.prototype=document.createElement("div"),e}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}("mui-popup{display:none;overflow:hidden;-ms-touch-action:manipulation;touch-action:manipulation}mui-popup,mui-popup .popup__mask{position:fixed;top:0;bottom:0;left:0;right:0}mui-popup .popup__mask{padding:0;margin:0;border:none;background-color:#000000;background-color:rgba(0, 0, 0, .4)}mui-popup .popup__wrapper{position:fixed;background-color:#fff;width:100%;bottom:0;border-top-left-radius:.8rem;border-top-right-radius:.8rem}mui-popup .popup__body{padding:1.5rem;overflow-x:hidden;overflow-y:auto;max-height:70vh;min-height:25vh}mui-popup .popup__header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;line-height:2rem;font-size:1.6rem;padding:1.5rem;text-align:center}mui-popup .popup__header--center{text-align:center}mui-popup .popup__header--left{text-align:left}mui-popup .popup__header .header__label{width:100%}mui-popup .popup__header .header__close{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 44 44'%3E%3Cpath fill-rule='evenodd' d='M24.008 21.852l8.97-8.968L31.092 11l-8.97 8.968L13.157 11l-1.884 1.884 8.968 8.968-9.24 9.24 1.884 1.885 9.24-9.24 9.24 9.24 1.885-1.884-9.24-9.24z'/%3E%3C/svg%3E\");background-repeat:no-repeat;height:2.8rem;width:2.8rem;position:absolute;right:1rem;top:1rem}.masker-showUp{-webkit-animation:muiFadeIn .2s linear;animation:muiFadeIn .2s linear}.popup-bounceInUp{-webkit-animation:muiBounceInUp .2s linear;animation:muiBounceInUp .2s linear}.popup-fadeOut{-webkit-animation:muiFadeOut .2s linear;animation:muiFadeOut .2s linear}.popup-slideDown{-webkit-animation:muiSlideOutDown .2s linear;animation:muiSlideOutDown .2s linear}");var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n()),t}(),c={prepareQuery:function(t){return t instanceof Function?t:function(e){return c.match(e,t)}},match:function(e,t){return(e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector).call(e,t)},findChild:function(e,t){for(var n=c.prepareQuery(t),o=0;o<e.childNodes.length;o++){var i=e.childNodes[o];if(i.nodeType===Node.ELEMENT_NODE&&n(i))return i}return null},isInstance:function(e,t){return Object.prototype.toString.call(e).toLowerCase()==="[object "+t.toLowerCase()+"]"},createElement:function(e,t){console.log("document.getElementById(IDSelector)",document.getElementById(e));var n=document.getElementById(e).content;console.log("template",n),c.setAttrOptions(n,t.conf||{});var o=document.importNode(n,!0);return console.log("cloneTemplate",o),o},setAttrOptions:function(e,t){for(var n in t){var o=document.createAttribute("conf-"+n);o.value=t[n],e.firstElementChild.attributes.setNamedItem(o)}},elementOutSidePreventScroll:function(r,a){var l={maxscroll:0};r.addEventListener("touchstart",function(e){var t=e.target,n=r.querySelector(a);t.classList.contains(a)||null!==c.getClosest(t,a)?(l.scrollY=n.scrollTop,l.posY=(e.targetTouches[0]||e).pageY,l.maxscroll=n.scrollHeight-n.clientHeight,l.elScroll=t):l.elScroll=null}),r.addEventListener("touchmove",function(e){l.elScroll||e.preventDefault(),e.maxscroll<=0&&e.preventDefault();var t=r.querySelector(a),n=e.targetTouches[0]||e,o=t.scrollTop,i=n.pageY-l.posY;0<i&&0==o?e.preventDefault():i<0&&o+1>=l.maxscroll&&e.preventDefault()})},getClosest:function(e,t){for(;e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null},colorLog:function(e,t){console.log("%c "+e,"background: #222; color: "+(t||"#bada55"))},clearConfAttr:function(){for(var t=this,e=[],n=this.attributes,o=0;o<this.attributes.length;o++){var i=n[o].name;-1<i.indexOf("conf-")&&e.push(i)}e.forEach(function(e){t.removeAttribute(e)})},getConfAttr:function(){for(var e={},t=this.attributes,n=0;n<this.attributes.length;n++){var o=t[n].name;-1<o.indexOf("conf-")&&(e[o.replace("conf-","")]=t[n].value)}return e},triggerElementEvent:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});return Object.keys(n).forEach(function(e){o[e]=n[e]}),e.dispatchEvent(o),o},_transitionEndEvents:["webkitAnimationEnd","animationend"]},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function u(e,t){if(null!=e)if("object"!==(void 0===e?"undefined":l(e))&&(e=[e]),s(e,"array"))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var s=function(e,t){return Object.prototype.toString.call(e).toLowerCase()==="[object "+t+"]"},e=function(){this.pfx=["webkitAnimationEnd","animationend"]};e.prototype.startElAnimate=function(e,t){e.classList.contains(t)||e.classList.add(t)},e.prototype.animate=function(e,n){var o=this;if(e){var i=[];s(e,"object")?i.push(e):i=e,this.fixAnimateData(i),i.forEach(function(e){var t=e.el;o.startElAnimate(t,e.style),e.animateHookEnable&&o.transitionEnd(t,i,n)})}},e.prototype.transitionEnd=function(t,n,o){if(!t)return function(){};var i=function(e){n.forEach(function(e){e.el.classList.remove(e.style)}),t==e.target&&(e.stopPropagation(),r(),o())},r=function(){c._transitionEndEvents.forEach(function(e){t.removeEventListener(e,i,!1)})};c._transitionEndEvents.forEach(function(e){t.addEventListener(e,i,!1)})},e.prototype.fixAnimateData=function(e){e.some(function(e){return!0===e.animateHookEnable})||(e[0].animateHookEnable=!0)};var i=new e,r=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._cancel=e._cancel.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),r(t,[{key:"_toggleStyle",value:function(e){this.style.display=e?"block":"none"}},{key:"_setVisible",value:function(e){var t=this,n=e?"show":"hide";if(c.triggerElementEvent(this,"pre"+n,{}),"show"===n){if(!this._animateData)return c.triggerElementEvent(this,"post"+n,{}),void this._toggleStyle(e);i.animate(this._animateData[n],function(){c.triggerElementEvent(t,"post"+n,{})}),this._toggleStyle(e)}else{if(!this._animateData)return c.triggerElementEvent(this,"post"+n,{}),void this._toggleStyle(e);i.animate(this._animateData[n],function(){t._toggleStyle(e),c.triggerElementEvent(t,"post"+n,{})})}}},{key:"_setNoScroll",value:function(e){e?document.querySelector("html").classList.add("noscroll"):document.querySelector("html").classList.remove("noscroll")}},{key:"_cancel",value:function(){console.log("\u70b9\u51fb\u4e86cancel"),this._setVisible(!1),this._setNoScroll(!1)}},{key:"show",value:function(){this._setVisible(!0),this._setNoScroll(!0)}},{key:"hide",value:function(){this._setVisible(!1),this._setNoScroll(!1)}},{key:"connectedCallback",value:function(){c.colorLog("connectedCallback\uff0clife-cycle \u9996\u6b21\u63d2\u5165\u5230DOM"),console.log(this._mask),this._mask&&this._mask.addEventListener("click",this._cancel)}},{key:"attributeChangedCallback",value:function(){c.colorLog("attributeChangedCallback, life-cycle \u5c5e\u6027\u53d8\u5316\u65f6")}},{key:"disconnectedCallback",value:function(){console.log("attributeChangedCallback, life-cycle \u4eceDOM\u79fb\u9664\u65f6")}}]),t}(),p=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();var f={header:"\u9876\u90e8\u6807\u9898"},d=".popup__body",t=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._compile(),e._triggerEvent=e._triggerEvent.bind(e),e._animateData={show:[{el:e._mask,style:"masker-showUp"},{el:e._popup,style:"popup-bounceInUp",animateHookEnable:!0}],hide:[{el:e._mask,style:"popup-fadeOut"},{el:e._popup,style:"popup-slideDown"}]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a),p(t,[{key:"_triggerEvent",value:function(e,t){c.triggerElementEvent(this,e,t)}},{key:"_compile",value:function(){var e=this;this.style.display="none",this.style.zIndex=10001;for(var t=document.createDocumentFragment();this.firstChild;)t.appendChild(this.firstChild);var n=c.getConfAttr.call(this),o=function n(){var o={};function e(e,t){"object"===l(o[t])&&"object"===(void 0===e?"undefined":l(e))?o[t]=n(o[t],e):o[t]=e}for(var t=0,i=arguments.length;t<i;t++)u(arguments[t],e);return o}(f,n),i='\n            <div class="popup__mask"></div>\n            <div class="popup__wrapper">\n               <div class="popup__container">\n                  <div class="popup__header line-bottom popup__header--'+(o.textAlign?o.textAlign:"left")+'">\n                       <div class="header__label">'+o.header+'</div>\n                       <div class="header__close"></div>\n                   </div>\n                   <div class="popup__body"></div>\n               </div>\n            </div>\n        ';this.insertAdjacentHTML("beforeend",i),this._popupBody.append(t),this._mask.style.zIndex=2e4,this._popup.style.zIndex=20001,this._closeEl.addEventListener("click",function(){e.close&&s(e.close,"function")&&e.close(),e._setVisible(!1)});var r=n["conf-scrollSelector"],a=r?r.value:d;c.elementOutSidePreventScroll(this,a)}},{key:"attributeChangedCallback",value:function(e,t,n){console.log(e,t,n),this.querySelector(".header__label").textContent=n}},{key:"_mask",get:function(){return c.findChild(this,".popup__mask")}},{key:"_popup",get:function(){return c.findChild(this,".popup__wrapper")}},{key:"_popupBody",get:function(){return this.querySelector(".popup__body")}},{key:"_closeEl",get:function(){return this.querySelector(".header__close")}}],[{key:"observedAttributes",get:function(){return["conf-header"]}}]),t}();return customElements.define("mui-popup",t),t});